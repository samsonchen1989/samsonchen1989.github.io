<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>ä»Dota2çš„ä¼ªéšæœºè°ˆå¼€ - Gamer Cat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
  
  <meta name="description" content="èµ·å› æ˜¯åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°æœ¨ä¸ƒä¸ƒå·¥ä½œå®¤è½¬å‘çš„è°ˆéšæœºå¤„ç†çš„ä¸€ä¸ªå†…éƒ¨è§†é¢‘ï¼Œæœ¨ä¸ƒä¸ƒæœ¬æ¥æ˜¯ä¸€ä¸ªåšFlashæ¸¸æˆåˆ†äº«å’Œé¡µæ¸¸çš„å…¬å¸ï¼Œè·Ÿç€æ‰‹æ¸¸æµªæ½®ï¼ŒæŠŠæ——ä¸‹çš„ã€Šåƒç´ ">
  <meta name="author" content="samsonchen">
  <meta itemprop="name" content="ä»Dota2çš„ä¼ªéšæœºè°ˆå¼€ - Gamer Cat">
  <meta itemprop="description" content="èµ·å› æ˜¯åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°æœ¨ä¸ƒä¸ƒå·¥ä½œå®¤è½¬å‘çš„è°ˆéšæœºå¤„ç†çš„ä¸€ä¸ªå†…éƒ¨è§†é¢‘ï¼Œæœ¨ä¸ƒä¸ƒæœ¬æ¥æ˜¯ä¸€ä¸ªåšFlashæ¸¸æˆåˆ†äº«å’Œé¡µæ¸¸çš„å…¬å¸ï¼Œè·Ÿç€æ‰‹æ¸¸æµªæ½®ï¼ŒæŠŠæ——ä¸‹çš„ã€Šåƒç´ ">
  <meta itemprop="image" content="https://samsonchen1989.github.io/img/author.jpg">
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@samsonchen_1989" />
  <meta name="twitter:title" content="ä»Dota2çš„ä¼ªéšæœºè°ˆå¼€ - Gamer Cat" />
  
  <meta name="twitter:description" content="hehe">
  
  <link rel="shortcut icon" href="https://samsonchen1989.github.io/img/favicon.ico"/>
  <link rel="apple-touch-icon" href="https://samsonchen1989.github.io/apple-touch-icon.png" />
  <link rel="apple-touch-icon-precomposed" href="https://samsonchen1989.github.io/apple-touch-icon.png" />
  <link rel="stylesheet" href="https://samsonchen1989.github.io/highlight/styles/github.css">
  <script src="https://samsonchen1989.github.io/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <link rel="stylesheet" href="https://samsonchen1989.github.io/font/hack/css/hack.min.css">
  <link rel="stylesheet" href="https://samsonchen1989.github.io/css/style.css">
</head>

<body>
  <header>
    <div>
  
  <div id="imglogo">
    <a href="https://samsonchen1989.github.io/"><img src="https://samsonchen1989.github.io/img/logo.svg" alt="Gamer Cat" title="Gamer Cat"/></a>
  </div>
  
  <div id="textlogo">
    <h1 class="site-name"><a href="https://samsonchen1989.github.io/" title="Gamer Cat">Gamer Cat</a></h1>
    <h2 class="blog-motto">å¶å°”ç å­—å’Œå†™ä»£ç ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ç¡è§‰ğŸ˜ªå’Œç©PS4çš„æ‡’çŒ«</h2>
  </div>
  <div class="navbar"><a class="navbutton navmobile" href="#" title="menu"></a></div>
  <nav class="animated">
    <ul>
      
      <li><a href="/">é¦–é¡µ</a></li>
      
      <li><a href="/about">å…³äº</a></li>
      
      <li>
        <form class="search" method="get" action="https://www.google.com/search">
          <div>
            <input type="text" id="search" name="q" placeholder="æœç´¢">
          </div>
        </form>
      </li>
    </ul>
  </nav>
</div>

  </header>
  <div id="container">
    <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody">
    <header class="article-info clearfix">
  <h1 itemprop="name">
      <a href="https://samsonchen1989.github.io/post/random/" title="ä»Dota2çš„ä¼ªéšæœºè°ˆå¼€" itemprop="url">ä»Dota2çš„ä¼ªéšæœºè°ˆå¼€</a>
  </h1>
  <p class="article-author">By
    
      <a href="https://samsonchen1989.github.io/" title="samsonchen">samsonchen</a>
    
  </p>
  <p class="article-time">
    <time datetime="2016-09-27 17:27:36 &#43;0800 HKT" itemprop="datePublished">2016å¹´09æœˆ27æ—¥</time>
  </p>
</header>

	<div class="article-content">
    
    

<p>èµ·å› æ˜¯åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°æœ¨ä¸ƒä¸ƒå·¥ä½œå®¤è½¬å‘çš„<a href="https://zhuanlan.zhihu.com/p/22630963">è°ˆéšæœºå¤„ç†çš„ä¸€ä¸ªå†…éƒ¨è§†é¢‘</a>ï¼Œæœ¨ä¸ƒä¸ƒæœ¬æ¥æ˜¯ä¸€ä¸ªåšFlashæ¸¸æˆåˆ†äº«å’Œé¡µæ¸¸çš„å…¬å¸ï¼Œè·Ÿç€æ‰‹æ¸¸æµªæ½®ï¼ŒæŠŠæ——ä¸‹çš„ã€Šåƒç´ éª‘å£«å›¢ã€‹æ”¹å¤´æ¢é¢æˆæ‰‹æ¸¸ç‰ˆã€Šå†’é™©ä¸æŒ–çŸ¿ã€‹å¤§è·æˆåŠŸï¼ˆè™½ç„¶æœ‰è§’å·ä¹¦åº—çš„æ­£ç‰ˆæˆæƒï¼Œä½†æ¸¸æˆå†…å®¹å¤§éƒ¨åˆ†æ‰“çš„éƒ½æ˜¯é›†è‹±ç¤¾ï¼Œè®²è°ˆç¤¾çš„æ“¦è¾¹çƒï¼Œæ¯”å¦‚é¸£äººæ”¹åæˆåŠè½¦å°¾å°‘å¹´ï¼ŒåæœŸç‰ˆæœ¬è¿˜æ”¹äº†é¢œè‰²é¿å«Œï¼‰ã€‚ä¸è°ˆè¿™äº›å…«å¦ï¼Œæ¯•ç«Ÿåœ¨å›½å†…è¦æ‰¾ä¸å·è…¥çš„çŒ«è¿˜æ˜¯å¾ˆå›°éš¾çš„ï¼Œmu77çŸ¥ä¹ä¸Šçš„ä¸“æ ä»è¿è¥åˆ°ç­–åˆ’ï¼Œè¿˜æ˜¯å¹²è´§æ»¡æ»¡ï¼Œæ¨èæœ‰å…´è¶£çš„äººå…³æ³¨ä¸‹ã€‚</p>

<p>è§†é¢‘é‡Œé¢èŠåˆ°Dota2çš„æŠ€èƒ½æ¦‚ç‡å¤„ç†æ–¹å¼ï¼Œæ¯”å¦‚å¤§é±¼äººï¼ˆSorryå¥½ä¹…æ²¡ç©Dotaäº†å·²ç»æƒ³ä¸èµ·æ¥è¿™ä½çš„çœŸåï¼‰çš„è¢«åŠ¨æŠ€èƒ½å‡æ»¡åï¼š</p>

<ul>
<li>æ¯æ¬¡æ”»å‡»æœ‰25%çš„å‡ ç‡è®©æ•Œäººçœ©æ™•ã€‚</li>
</ul>

<p>ä¸€èˆ¬åšæ³•ç”¨<strong>çº¯éšæœº True random distribution</strong>çš„æ–¹å¼ï¼Œæ¯æ¬¡æ”»å‡»æ—¶è®¡ç®—æ¦‚ç‡ï¼Œç‹¬ç«‹åˆ¤æ–­æ˜¯å¦è§¦å‘çœ©æ™•ã€‚ä¸è¿‡å¯èƒ½ä¼šå‡ºç°ä¸€äº›ä½“éªŒé—®é¢˜ï¼š</p>

<ol>
<li>å› ä¸ºæ¯æ¬¡ç‹¬ç«‹è®¡ç®—æ¦‚ç‡ï¼Œæé™æƒ…å†µä¼šå¯¼è‡´ä¸€ç›´è§¦å‘çœ©æ™•å’Œä¸€ç›´ä¸è§¦å‘ï¼Œé—´æ¥é€ æˆæ¬§çš‡å’Œéæ´²é…‹é•¿ä¹‹é—´çš„æˆ˜äº‰ã€‚</li>
<li>ä»ç©å®¶ä½“éªŒä¸Šæ¥è¯´ï¼Œæ„Ÿå®˜ä¸Š25%çš„å‡ ç‡ï¼Œè¶…è¿‡5ï¼Œ6æ¬¡ä¸è§¦å‘ï¼Œä»–å°±ä¼šå¼€å§‹æ€€ç–‘å‡ ç‡æ˜¯å¦è¢«ç­–åˆ’è¿è¥ç¯¡æ”¹ï¼Œå¹•åæ˜¯å¦æœ‰è‚®è„çš„PYäº¤æ˜“ï¼Œè€Œä¸æ˜¯å›æƒ³ä¸‹åˆä¸­çš„æ•°å­¦è¯¾ã€‚</li>
</ol>

<p>çº¯éšæœºåœ¨æ•°å­¦ä¸Šæ˜¯æ— ç½ªçš„ï¼Œæœºå™¨åº•å±‚çš„éšæœºå‡½æ•°æ˜¯æ¸…ç™½çš„ï¼ˆå…¶å®ä¹Ÿä¸æ˜¯é‚£ä¹ˆæ¸…ç™½ï¼Œæ¯•ç«Ÿ<strong>çº¯éšæœºæ˜¯ä¸å­˜åœ¨çš„</strong>ï¼Œä¸è¿‡è¿™ä¸ªå°±æ‰¯æ·±äº†ï¼Œå…ˆé»˜è®¤ä¸€èˆ¬çš„randomæ¥å£å‡½æ•°å°±æ˜¯çº¯éšæœºï¼‰ï¼Œä½†æ˜¯æœ‰äº›æ—¶å€™å¹¶ä¸æ˜¯æœ€ä½³è§£å†³æ–¹æ¡ˆã€‚</p>

<h3 id="ç”¨ä¼ªéšæœºåˆ†å¸ƒpseudo-random-distributionå¤„ç†æ¦‚ç‡">ç”¨ä¼ªéšæœºåˆ†å¸ƒPseudo-random distributionå¤„ç†æ¦‚ç‡</h3>

<p>Dota2çš„ä¼ªéšæœºåˆ†å¸ƒé‡‡ç”¨æ¦‚ç‡è¡¥å¿çš„æ–¹å¼ï¼Œæ¯æ¬¡è§¦å‘æ¦‚ç‡ä»ä¸€ä¸ªå€¼å¼€å§‹é€’å¢ï¼Œç¬¬Næ¬¡çš„è§¦å‘æ¦‚ç‡P(N) = C * Nï¼Œæ¯”å¦‚25%çš„å‡ ç‡ï¼ŒCå€¼å¤§æ¦‚ä¸º8.5%ï¼Œè¿ç®—æµç¨‹å¦‚ä¸‹ï¼š</p>

<ol>
<li>ç¬¬ä¸€æ¬¡è§¦å‘çœ©æ™•æ¦‚ç‡ä¸º8.5%</li>
<li>ç¬¬äºŒæ¬¡ä¸º17%ï¼Œä»¥æ­¤ç±»æ¨é€’å¢</li>
<li>å¦‚æœè§¦å‘çœ©æ™•æˆåŠŸï¼Œåˆ™æ¦‚ç‡é‡æ–°ä»8.5%å¼€å§‹é€’å¢è®¡ç®—ã€‚</li>
</ol>

<p>è¿™ç§æ–¹å¼ä½¿å¾—è¿ç»­è§¦å‘æˆ–è¿ç»­ä¸è§¦å‘çš„å‡ ç‡é™ä½ï¼Œé¿å…äº†è¿æ°”æˆåˆ†è¿‡äºå½±å“æˆ˜æ–—ç»“æœï¼ˆç‰¹åˆ«æ˜¯ç«æŠ€æ¸¸æˆï¼‰ã€‚</p>

<p>ä¸€èˆ¬å‡ ç‡å¯¹åº”çš„Cå€¼å¯ä»¥å‚è€ƒä¸‹é¢è¿™å¼ å›¾ã€‚P(T)ä»£è¡¨é¢„æœŸå€¼ï¼Œå°±æ˜¯æ¸¸æˆä¸­æ˜¾ç¤ºçš„å‡ ç‡å€¼ã€‚P(A)æ˜¯ç”¨äº†ä¼ªéšæœºåçš„å®é™…æ¦‚ç‡ã€‚MaxNè¡¨ç¤ºæœ€åæƒ…å†µä¸‹è§¦å‘æ¦‚ç‡çš„æ¬¡æ•°ã€‚</p>

<p><img src="/img/rpic1.png" alt="" /></p>

<p>è®¡ç®—Cå€¼çš„æ–¹å¼å’Œç¨‹åºå®ç°å¯ä»¥å‚è€ƒ<a href="http://gaming.stackexchange.com/questions/161430/calculating-the-constant-c-in-dota-2-pseudo-random-distribution">è¿™ä¸ªé“¾æ¥</a>ä¸‹çš„å›ç­”ï¼Œæœ‰C#çš„å®ç°ä»£ç ï¼š</p>

<pre><code class="language-csharp">//CfromPæ˜¯ä¸»å‡½æ•°ï¼Œä¼ å…¥ç†è®ºæ¦‚ç‡På°±å¯ä»¥æ±‚å¾—é€’å¢çš„Cå€¼
public decimal CfromP( decimal p )
{
    decimal Cupper = p;
    decimal Clower = 0m;
    decimal Cmid;
    decimal p1;
    decimal p2 = 1m;
    while(true)
    {
        Cmid = ( Cupper + Clower ) / 2m;
        p1 = PfromC( Cmid );
        if ( Math.Abs( p1 - p2 ) &lt;= 0m ) break;

        if ( p1 &gt; p )
        {
            Cupper = Cmid;
        }
        else
        {
            Clower = Cmid;
        }

        p2 = p1;
    }

    return Cmid;
}

private decimal PfromC( decimal C )
{
    decimal pProcOnN = 0m;
    decimal pProcByN = 0m;
    decimal sumNpProcOnN = 0m;

    int maxFails = (int)Math.Ceiling( 1m / C );
    for (int N = 1; N &lt;= maxFails; ++N)
    {
        pProcOnN = Math.Min( 1m, N * C ) * (1m - pProcByN);
        pProcByN += pProcOnN;
        sumNpProcOnN += N * pProcOnN;
    }

    return ( 1m / sumNpProcOnN );
}
</code></pre>

<p>ä¸Šé¢çš„ä¼ªéšæœºåˆ†å¸ƒç®—æ˜¯ç”¨æ¦‚ç‡è¡¥å¿çš„æ–¹å¼æ§åˆ¶æ¦‚ç‡æ¥æ”¹å–„ç©å®¶çš„ä½“éªŒï¼Œè¯¦ç»†çš„å¯ä»¥å‚è€ƒ<a href="http://dota2.gamepedia.com/Pseudo-random_distribution">Dota2çš„Wiki</a>ï¼ˆæ‰“Dota2ï¼Œå‘å†°è›™å­¦æ•°å­¦ï¼‰ã€‚</p>

<p>å½“ç„¶ä¹Ÿæœ‰å…¶ä»–æ–¹å¼æ§åˆ¶éšæœºæ•°å’Œæ¦‚ç‡ï¼Œæ­£å¥½å‰ä¸€é˜µå­çœ‹äº†ä¸€ä¸ª<a href="http://www.redblobgames.com/articles/probability/damage-rolls.html">ä»D&amp;Dæ·éª°è§’åº¦è°ˆæ§åˆ¶éšæœºåˆ†å¸ƒ</a>çš„æ–‡ç« ï¼Œä¸‹é¢ä¹Ÿç®—ä¸€ä¸ªç¿»è¯‘å’Œæ•´ç†ã€‚</p>

<h3 id="æˆ‘è¿™æŠŠå¯æ˜¯1d2æœ‰æ¯’çš„é£åˆ€">æˆ‘è¿™æŠŠå¯æ˜¯1d2æœ‰æ¯’çš„é£åˆ€</h3>

<p>D&amp;Dé‡Œé¢<strong>NdS</strong>è¡¨ç¤ºæŠ•æ·Sé¢çš„éª°å­Næ¬¡ï¼Œç´¯åŠ ç»“æœã€‚æ¯”å¦‚1d12è¡¨ç¤ºæŠ•æ·ä¸€ä¸ª12é¢éª°å­ä¸€æ¬¡ï¼Œ3d4è¡¨ç¤ºæŠ•æ·ä¸€ä¸ª4é¢éª°å­3æ¬¡ã€‚</p>

<p>å‡è®¾æˆ‘ä»¬è¦è·å–[0,24]ä¹‹é—´çš„éšæœºå€¼ï¼Œå¯ä»¥å…ˆè®¾ç½®ä¸€ä¸ªå‡½æ•°rollDice(N, S)æ¥æ¨¡æ‹Ÿéª°å­æŠ•æ·ï¼š</p>

<pre><code class="language-csharp">public static int rollDice(int N, int S) {
    int value = 0;
    for (int i = 0; i &lt; N; i++) {
        //æ¯æ¬¡éšæœºç»“æœä¸º[0, S]
        value += Random.Range(0, S + 1);
    }

    return value;
}
</code></pre>

<p>æˆ‘ä»¬å¯ä»¥rollDice(1,24)ï¼Œä¹Ÿå¯ä»¥æ‹†åˆ†æˆ2æ¬¡ï¼Œå˜æˆrollDice(2,12)ï¼Œå˜æˆä¸¤æ¬¡[0,12]çš„å’Œï¼Œä»¥æ­¤ç±»æ¨rollDice(3,8)ã€rollDice(4,6)ï¼Œä¸‹é¢è¿™å¼ å›¾å¯ä»¥çœ‹åˆ°æœ€ç»ˆç»“æœçš„åˆ†å¸ƒå˜åŒ–ï¼š</p>

<p><img src="/img/rpic5.jpg" alt="" /></p>

<p>å¯ä»¥çœ‹åˆ°æŠ•æ·çš„æ¬¡æ•°è¶Šå¤šï¼Œæœ€ç»ˆç»“æœåˆ†å¸ƒå°±è¶Šé›†ä¸­åœ¨[0,24]çš„å¹³å‡å€¼é™„è¿‘ï¼Œæ‰€ä»¥4d6çš„æ­¦å™¨æ¯”3d8çš„æ­¦å™¨è¾“å‡ºæ›´å¹³ç¨³ï¼Œä½†3d8çš„æ­¦å™¨é€ æˆé«˜ä¼¤å®³çš„å‡ ç‡ä¹Ÿæ›´é«˜ã€‚</p>

<p>é™¤äº†æ§åˆ¶éšæœºå–å€¼çš„é›†ä¸­åŒºåŸŸï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨ç®€å•çš„æ–¹å¼æ§åˆ¶éšæœºå–å€¼æ˜¯<strong>å¤§éƒ¨åˆ†åˆ†æ•£åœ¨å¹³å‡å€¼ä»¥ä¸‹</strong>è¿˜æ˜¯<strong>å¤§éƒ¨åˆ†åˆ†æ•£åœ¨å¹³å‡å€¼ä»¥ä¸Š</strong>ã€‚</p>

<h5 id="ä¸¤æ¬¡éšæœºå–è¾ƒå¤§-è¾ƒå°å€¼">ä¸¤æ¬¡éšæœºå–è¾ƒå¤§/è¾ƒå°å€¼</h5>

<p>è¿˜æ˜¯ä»¥å–[0,24]ä¹‹é—´éšæœºå€¼ä¸ºä¾‹ï¼Œæ¯æ¬¡rollDice(2,12)ä¸¤æ¬¡ï¼Œå–è¾ƒå¤§å€¼ï¼š</p>

<pre><code class="language-csharp">int roll1 = rollDice(2, 12);
int roll2 = rollDice(2, 12);
int result = Math.Max(roll1,  roll2);
</code></pre>

<p>åˆ†å¸ƒå›¾å¦‚ä¸‹ï¼š</p>

<p><img src="/img/rpic2.png" alt="" /></p>

<p>åè¿‡æ¥ï¼Œå–è¾ƒå°å€¼ï¼Œå¯ä»¥è·å¾—é›†ä¸­åœ¨å¹³å‡å€¼ä»¥ä¸‹çš„åˆ†å¸ƒï¼š</p>

<pre><code class="language-chsarp">int roll1 = rollDice(2, 12)
int roll2 = rollDice(2, 12)
int result = Math.Min(roll1, roll2);
</code></pre>

<p><img src="/img/rpic4.png" alt="" /></p>

<p>å–è¾ƒå°å€¼åœ¨è®¡ç®—ä¼¤å®³å€¼æ¯”è¾ƒå¸¸è§ï¼Œæ¯”å¦‚ä¸€ä¸ªè§’è‰²çš„æ”»å‡»åŠ›åœ¨20åˆ°40ä¹‹é—´ï¼Œåˆ©ç”¨è¿™ç§æ–¹æ³•å¯ä»¥ä½¿å¾—æœ€åç»“æœé›†ä¸­åœ¨è¾ƒä½çš„èŒƒå›´ï¼Œé«˜ä¼¤å®³å‡ºç°çš„å‡ ç‡è¾ƒä½ã€‚</p>

<h5 id="ä¸‰æ¬¡éšæœºå–è¾ƒå¤§çš„ä¸¤ä¸ªå€¼">ä¸‰æ¬¡éšæœºå–è¾ƒå¤§çš„ä¸¤ä¸ªå€¼</h5>

<p>rollDice(1,12)ä¸‰æ¬¡ï¼Œå–è¾ƒå¤§çš„ä¸¤ä¸ªå€¼ï¼š</p>

<pre><code class="language-chsarp">int roll1 = rollDice(1, 12);
int roll2 = rollDice(1, 12);
int roll3 = rollDice(1, 12);

int result = roll1 + roll2 + roll3;
result = result - Math.Min(roll1, roll2, roll3);
</code></pre>

<p>åˆ†å¸ƒå›¾å¦‚ä¸‹ï¼š</p>

<p><img src="/img/rpic3.png" alt="" /></p>

<p>å¯ä»¥çœ‹å‡ºæ¯”ä¸¤æ¬¡å–è¾ƒå¤§/è¾ƒå°å€¼åˆ†å¸ƒæ›´ä¸ºå¹³æ»‘ã€‚</p>

<p>æ€»ç»“ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°åœ¨æ§åˆ¶æŸä¸ªèŒƒå›´å†…éšæœºæ•°æ—¶ï¼Œå¯ä»¥ä»ä¸‹é¢å‡ ä¸ªè§’åº¦è¿›è¡Œè‡ªå®šä¹‰ä»¥æ»¡è¶³éœ€æ±‚ï¼š</p>

<ol>
<li><strong>èŒƒå›´</strong>ã€‚ç¡®å®šéšæœºèŒƒå›´çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œå¦‚æœéœ€è¦å¯ä»¥åšä¸€äº›åç§»ï¼Œæ¯”å¦‚[20, 30]å¯ä»¥åˆ†è§£ä¸º20 + rollDice(1, 10)ã€‚</li>
<li><strong>æ–¹å·®</strong>ã€‚å°†ä¸€æ¬¡éšæœºåˆ†è§£ä¸ºå¤šæ¬¡éšæœºï¼Œå¯ä»¥ä½¿ç»“æœæ›´é è¿‘ä¸­é—´å€¼ã€‚ç›¸åï¼Œæ¬¡æ•°è¶Šå°‘ï¼Œç»“æœåˆ†å¸ƒèŒƒå›´è¶Šå¹¿ã€‚</li>
<li><strong>ä¸å¯¹ç§°æ€§</strong>ã€‚å¯ä»¥é€šè¿‡ä¸Šé¢ä»‹ç»çš„ä¸¤ç§æ–¹æ³•ï¼Œä½¿éšæœºç»“æœæ›´å¤šåˆ†å¸ƒåœ¨å¹³å‡å€¼ä¹‹å‰æˆ–è€…ä¹‹åã€‚</li>
</ol>

<h3 id="è‡ªå®šä¹‰æ¦‚ç‡åˆ†å¸ƒ">è‡ªå®šä¹‰æ¦‚ç‡åˆ†å¸ƒ</h3>

<p>å¾ˆå¤šæƒ…å†µä¸‹ï¼Œç­–åˆ’è¿‡æ¥æ‰¾ä½ çš„æ—¶å€™ï¼Œæƒ…æ™¯æœ‰å¯èƒ½æ˜¯ï¼šæˆ‘è¿™é‡Œæœ‰10ç§æ‰è½ç‰©å“ï¼Œæ¯ç§çš„æ‰ç‡æˆ‘éƒ½æƒ³å•ç‹¬é…ç½®ï¼Œæ¯”å¦‚Aæ‰ç‡10%ï¼ŒBæ‰ç‡20%ç­‰ç­‰å’Œä¸€ä¸ªExcelæ–‡ä»¶ã€‚</p>

<p>æœ€ç»ˆçš„é…ç½®æ–‡ä»¶å¯èƒ½æ˜¯åƒè¿™æ ·ä¸€ä¸ªæ•°ç»„ï¼Œå‰é¢æ˜¯æ‰ç‡ï¼ˆä»¥100ç®—100%ï¼‰ï¼Œåé¢è·Ÿç€ç‰©å“IDã€‚</p>

<pre><code class="language-lua">local dropRate = {
    {10, 100001},
    {20, 100002},
    {30, 100003},
    {40, 100004},
}
</code></pre>

<p>æ‰ç‡çš„æ€»å’Œä¸ä¸€å®šæ­£å¥½æ˜¯100ï¼Œæ¯•ç«Ÿè¦è€ƒè™‘äº›å¯¹é…ç½®æ–‡ä»¶çš„å®¹é”™æ€§ï¼Œæ‰€ä»¥å…ˆç®—å‡ºæ¦‚ç‡å’ŒsumRateï¼Œå–random(sumRate)çš„å€¼valueï¼Œä¾æ¬¡éå†dropDateè¡¨ï¼Œç´¯åŠ æ¦‚ç‡å’Œweightï¼Œå¦‚æœvalueå°äºç­‰äºweightï¼Œåˆ™ç®—æ˜¯è½åœ¨å½“å‰åŒºé—´ï¼Œè¿”å›å¯¹åº”çš„ç‰©å“IDã€‚æˆ‘ç”¨luaå†™äº†ä¸€æ®µæµ‹è¯•ä»£ç ï¼Œæ¯•ç«Ÿluaçš„tableå®åœ¨æ˜¯å¤ªæ–¹ä¾¿äº†ã€‚</p>

<pre><code class="language-lua">local dropRate = {
    {10, 100001},
    {20, 100002},
    {30, 100003},
    {40, 100004},
}

local distribute = {
    [100001] = 0,
    [100002] = 0,
    [100003] = 0,
    [100004] = 0,
}

local checkRate = function(t, value)
    local weight = 0
    for i=1,#t do
        weight = weight + t[i][1]
        if value &lt;= weight then
            return t[i][2]
        end
    end

    return nil
end

local getDropItem = function(t)
    local weightTotal = 0
    for k,v in pairs(t) do
        weightTotal = weightTotal + v[1]
    end

    local value = math.random(weightTotal)

    return checkRate(t, value)
end

local main = function()
    --ç”¨å€’åºæ—¶é—´è®¾ç½®randomçš„seedï¼Œç¡®ä¿seedéšæ—¶é—´æ˜¾è‘—å˜åŒ–
    math.randomseed(tostring(os.time()):reverse():sub(1, 6))

    for i=1,10000 do
        local id = getDropItem(dropRate)
        if id and distribute[id] then
            distribute[id] = distribute[id] + 1
        end
    end

    for index,dis in pairs(distribute) do
        print(&quot;index:&quot;,index)
        print(&quot;dis:&quot;,dis)
        print(&quot;percent:&quot;,dis / 10000)
        print(&quot;=================&quot;)
    end
end

main()
</code></pre>

<p>æµ‹è¯•ç»“æœå’Œé…ç½®æ¦‚ç‡å¾ˆæ¥è¿‘ï¼Œè¿™æ ·å°±å¯ä»¥è®©ç­–åˆ’å°½æƒ…å‘æŒ¥ä»–çš„å¥‡æ€ªæ‰ç‡äº†ã€‚</p>

<h3 id="æ€»ç»“">æ€»ç»“</h3>

<p>ä¸Šé¢çš„éƒ¨åˆ†åªæ˜¯æœ€è¿‘çœ‹åˆ°çš„ä¸€äº›æœ‰æ„æ€çš„éšæœºæ•°è®¨è®ºæ•´ç†ï¼ŒçœŸæ­£åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œéšæœºæ•°çš„å¤„ç†æ˜¯è·Ÿéšä¸åŒçš„éœ€æ±‚åšå˜åŒ–çš„ï¼Œéšæœºå¯ä»¥å¢åŠ æ¸¸æˆè¿‡ç¨‹çš„ä¹è¶£ï¼Œå¯ä»¥ç»™æ¸¸æˆå¢åŠ å–ç‚¹ï¼Œä¹Ÿå¯ä»¥å˜æˆå„ç§â€œå‘â€ï¼Œå¯¹äºå¼€å‘æ¥è¯´ï¼Œåªè¦è¿™ä¸ªå‘æ˜¯å¯æ§åˆ¶çš„ï¼Œä¸è¦å‘åˆ°è‡ªå·±å°±è¡Œäº†~</p>

	</div>
  <footer class="article-footer clearfix">
  



  <div class="article-share" id="share">
    <div data-url="https://samsonchen1989.github.io/post/random/" data-title="ä»Dota2çš„ä¼ªéšæœºè°ˆå¼€" data-tsina="" class="share clearfix">
    </div>
  </div>
</footer>

	</article>
  


<section class="comment">
<div id="disqus_thread"></div>
</section>
<script>


var disqus_config = function () {
this.page.url = "https://samsonchen1989.github.io/post/random/";
this.page.identifier = "https://samsonchen1989.github.io/post/random/";
};
(function() { 
var d = document, s = d.createElement('script');

s.src = '//.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


</div>

    <div class="openaside"><a class="navbutton" href="#" title="æ˜¾ç¤ºä¾§è¾¹æ "></a></div>
<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="éšè—ä¾§è¾¹æ "></a></div>
<aside class="clearfix">
  



  



  
  <div class="archiveslist">
    <p class="asidetitle">å½’æ¡£</p>
    <ul class="archive-list">
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://samsonchen1989.github.io/post/#2016-10">2016å¹´10æœˆ</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://samsonchen1989.github.io/post/#2016-09">2016å¹´09æœˆ</a><span class="archive-list-count">2</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://samsonchen1989.github.io/post/#2016-08">2016å¹´08æœˆ</a><span class="archive-list-count">2</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://samsonchen1989.github.io/post/#2016-07">2016å¹´07æœˆ</a><span class="archive-list-count">1</span>
      </li>
      
    </ul>

  </div>


  



  

</aside>
</div>

  </div>
  <footer><div id="footer" >
  
  <div class="line">
    <span></span>
    <div style='background:no-repeat url("https://samsonchen1989.github.io/img/head.jpeg") left top;-webkit-background-size:6.875em 6.875em;-moz-background-size:6.875em 6.875em;background-size:6.875em 6.875em;' class="author" ></div>
  </div>
  
  
  <section class="info">
    <p>Samsonchenï¼šæ— è¯ç¨‹åºå‘˜ï¼Œæ¸¸æˆçˆ±å¥½è€…ï¼Œpsnå¥–æ¯å’¸é±¼ <br/> å¯¹AIï¼ŒShaderå’ŒProcedural Content Generationæ¯”è¾ƒæ„Ÿå…´è¶£</p>
  </section>
  
  <div class="social-font clearfix">
    
    <a href="http://weibo.com/canselwicecs" target="_blank" title="weibo"></a>
    
    
    <a href="https://twitter.com/samsonchen_1989" target="_blank" title="twitter"></a>
    
    
    <a href="https://github.com/samsonchen1989" target="_blank" title="github"></a>
    
    
    
  </div>
  <p class="copyright">Powered by <a href="http://gohugo.io" target="_blank" title="hugo">hugo</a> and Theme by <a href="https://github.com/coderzh/hugo-pacman-theme" target="_blank" title="hugo-pacman-theme">hugo-pacman-theme</a> Â© 2016
    
    <a href="https://samsonchen1989.github.io/" target="_blank" title="samsonchen">samsonchen</a>
    
  </p>
</div>
</footer>
  <script src="https://samsonchen1989.github.io/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
done = false;
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  $('form.search').on('submit', function (event) {
    if (false === done) {
      event.preventDefault();
      var orgVal = $(this).find('#search').val();
      $(this).find('#search').val('site:https:\/\/samsonchen1989.github.io\/ ' + orgVal);
      done = true;
      $(this).submit();
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>æ‰«æäºŒç»´ç åˆ†äº«åˆ°å¾®ä¿¡æœ‹å‹åœˆ</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});
</script>


<link rel="stylesheet" href="https://samsonchen1989.github.io/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="https://samsonchen1989.github.io/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
});
</script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', '', 'auto');
  ga('send', 'pageview');
  $('#messagesbsb').remove();
</script>



</body>
</html>
